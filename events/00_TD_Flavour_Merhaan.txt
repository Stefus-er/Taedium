namespace = merhaan

country_event = { #pan-merhaan church
	id = merhaan.1
	title = merhaan.1.t
	desc = merhaan.1.desc

	picture = RELIGIOUS_MIGRANTS_eventPicture

	trigger = {
		current_age = age_of_reformation
		owns = 3185
	}
	fire_only_once = yes

	mean_time_to_happen = {
		days = 1825
	}

	immediate = {
		trigger_switch = {
			on_trigger = religion
			orundes = {
				set_country_flag = orundes_religion_flag
			}
			tanagan = {
				set_country_flag = tanagan_religion_flag
			}
			navch = {
				set_country_flag = navch_religion_flag
			}
			khondii = {
				set_country_flag = khondii_religion_flag
			}
			salbar = {
				set_country_flag = salbar_religion_flag
			}
		}
	}

	option = { #convert
		name = merhaan.1.a
		change_religion = ovogsteg
		trigger_switch = {
			on_trigger = has_country_flag
			orundes_religion_flag = {
				add_harmonized_religion = orundes
			}
			tanagan_religion_flag = {
				add_harmonized_religion = tanagan
			}
			navch_religion_flag = {
				add_harmonized_religion = navch
			}
			khondii_religion_flag = {
				add_harmonized_religion = khondii
			}
			salbar_religion_flag = {
				add_harmonized_religion = salbar
			}
		}
		hidden_effect = {
			country_event = {
				id = merhaan.3
				days = 0
			}
		}
	}

	option = { #go away
		name = merhaan.1.b
		add_country_modifier = {
			name = merhaan_shaman_exodus
			duration = 912
		}
		set_country_flag = merhaan_shamans_left
		hidden_effect = {
			if = {
				limit = {
					any_neighbor_country = {
						religion_group = merhaan
						NOT = { has_country_flag = merhaan_shamans_left }
					}
				}
				random_neighbor_country = {
					country_event = {
						id = merhaan.2
						days = 365
					}
				}
			}
			else_if = {
				limit = {
					any_known_country = {
						religion_group = merhaan
						NOT = { has_country_flag = merhaan_shamans_left }
					}
				}
				random_known_country = {
					country_event = {
						id = merhaan.2
						days = 365
					}
				}
			}
		}
	}

}

country_event = { #pan-merhaan church (exodus)
	id = merhaan.2
	title = merhaan.2.t
	desc = merhaan.2.desc

	picture = RELIGIOUS_MIGRANTS_eventPicture

	is_triggered_only = yes

	immediate = {
		trigger_switch = {
			on_trigger = religion
			orundes = {
				set_country_flag = orundes_religion_flag
			}
			tanagan = {
				set_country_flag = tanagan_religion_flag
			}
			navch = {
				set_country_flag = navch_religion_flag
			}
			khondii = {
				set_country_flag = khondii_religion_flag
			}
			salbar = {
				set_country_flag = salbar_religion_flag
			}
		}
	}

	option = { #convert
		name = merhaan.2.a
		change_religion = ovogsteg
		trigger_switch = {
			on_trigger = has_country_flag
			orundes_religion_flag = {
				add_harmonized_religion = orundes
			}
			tanagan_religion_flag = {
				add_harmonized_religion = tanagan
			}
			navch_religion_flag = {
				add_harmonized_religion = navch
			}
			khondii_religion_flag = {
				add_harmonized_religion = khondii
			}
			salbar_religion_flag = {
				add_harmonized_religion = salbar
			}
		}
		add_country_modifier = {
			name = merhaan_shaman_influx
			duration = 912
		}
		hidden_effect = {
			country_event = {
				id = merhaan.3
				days = 0
			}
		}
	}

	option = { #go away
		name = merhaan.2.b
		add_country_modifier = {
			name = merhaan_shaman_exodus
			duration = 912
		}
		set_country_flag = merhaan_shamans_left
		hidden_effect = {
			if = {
				limit = {
					any_neighbor_country = {
						religion_group = merhaan
						NOT = { has_country_flag = merhaan_shamans_left }
					}
				}
				random_neighbor_country = {
					country_event = {
						id = merhaan.2
						days = 365
					}
				}
			}
			else_if = {
				limit = {
					any_known_country = {
						religion_group = merhaan
						NOT = { has_country_flag = merhaan_shamans_left }
					}
				}
				random_known_country = {
					country_event = {
						id = merhaan.2
						days = 365
					}
				}
			}
		}
	}

}

country_event = { #pan-merhaan church introduction
	id = merhaan.3
	title = merhaan.3.t
	desc = merhaan.3.desc

	picture = RELIGIOUS_MIGRANTS_eventPicture

	is_triggered_only = yes

	option = { #kay
		name = merhaan.3.a
		add_country_modifier = {
			name = merhaan_starting_enthusiasm
			duration = 18250
		}
		set_country_flag = first_ovogsteg_nation
	}


}

country_event = { #pan-merhaan church solidified
	id = merhaan.4
	title = merhaan.4.t
	desc = merhaan.4.desc

	picture = RELIGIOUS_MIGRANTS_eventPicture

	is_triggered_only = yes
	trigger = {
		calc_true_if = {
			has_harmonized_with = orundes
			has_harmonized_with = tanagan
			has_harmonized_with = navch
			has_harmonized_with = khondii
			has_harmonized_with = salbar
			amount = 3
		}
		has_country_flag = first_ovogsteg_nation
	}

	immediate = {
		clr_country_flag = first_ovogsteg_nation
	}

	option = { #winning
		name = merhaan.4.a
	}


}

country_event = { #pan-merhaan church collapse
	id = merhaan.5
	title = merhaan.5.t
	desc = merhaan.5.desc

	picture = RELIGIOUS_MIGRANTS_eventPicture

	is_triggered_only = yes
	trigger = {
		had_country_flag = {
			flag = first_ovogsteg_nation
			days = 18250
		}
	}

	immediate = {
		clr_country_flag = first_ovogsteg_nation
	}

	option = { #losin
		name = merhaan.5.a
		add_country_modifier = {
			name = merhaan_church_collapsed
			duration = 0
		}
	}


}

country_event = { #pan-merhaan church solidified after collapse
	id = merhaan.6
	title = merhaan.6.t
	desc = merhaan.6.desc

	picture = RELIGIOUS_MIGRANTS_eventPicture

	is_triggered_only = yes
	trigger = {
		has_harmonized_with = orundes
		has_harmonized_with = tanagan
		has_harmonized_with = navch
		has_harmonized_with = khondii
		has_harmonized_with = salbar
		has_country_modifier = merhaan_church_collapsed
	}

	option = { #winning after losin
		name = merhaan.6.a
		remove_country_modifier = merhaan_church_collapsed
	}


}