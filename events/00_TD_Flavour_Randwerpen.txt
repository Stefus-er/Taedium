namespace = randwerpen
# The randwerpen events for Danieczek


## 15 years of boosts on startup for randwerpen
country_event = {
	id = randwerpen.1
	title = randwerpen.1.t
	desc = randwerpen.1.desc

	picture = SIEGE_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		tag = RAN
	}

	option = {
		name = randwerpen.1.a
		add_country_modifier = { 
			name = randwerpian_deterrence
			duration = 5475
		}
		1690 = { add_permanent_claim = ROOT }
		1683 = { add_permanent_claim = ROOT }
		1680 = { add_permanent_claim = ROOT }
	}
}

## 10 years of debuffs if country starts conquest outside of intended region.
country_event = {
	id = randwerpen.2
	title = randwerpen.2.t
	desc = randwerpen.2.desc

	picture = LIBERUM_VETO_eventPicture

	trigger = {
		has_country_modifier = randwerpian_deterrence
		num_of_owned_provinces_with = {
			NOT = { region = noordland_region }
			value = 6
		}
	}

	mean_time_to_happen = {
		days = 30
	}
	#is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = randwerpen.2.a
		remove_country_modifier = randwerpian_deterrence
		set_country_flag = RAN_Expanded_outside_Nifthem
		add_country_modifier = { 
			name = randwerpen_misguided_wrath
			duration = 3650
		}
	}
}

## Give claim, cores and war, or -25 prestige
country_event = {
	id = randwerpen.3
	title = randwerpen.3.t
	desc = randwerpen.3.desc

	picture = MILITARY_CAMP_eventPicture
	
	trigger = {
		NOT = { has_country_modifier = randwerpian_deterrence }
		NOT = { has_country_flag = RAN_Expanded_outside_Nifthem }
		tag = RAN
		is_year = 1450
	}
	#is_triggered_only = yes
	mean_time_to_happen = {
		days = 60
	}
	fire_only_once = yes

	option = {
		name = randwerpen.3.a
		EHR = { #core on trade dep, rest claims
			every_subject_country = {
				limit = {
					capital_scope = { region = noordland_region }
				}
				if = {
					limit = { is_subject_of_type = trade_dependency }
					every_owned_province = {
						limit = { is_nifthem_province = yes	}
						add_core = RAN
						set_province_flag = RAN_nifthem_core_province_flag
					}
				} else = {
					every_owned_province = {
						limit = { is_nifthem_province = yes	}
						add_claim = RAN
					}
				}
			}
			every_owned_province = {
				limit = {
					is_nifthem_province = yes
				}
				add_claim = RAN
			}
		}
		declare_war_with_cb = {
			who = EHR
			casus_belli = cb_core
			war_goal_province = 1673
		}
		set_country_flag = RAN_At_war_with_EHR
		EHR = {
			every_subject_country = {
				limit = {
					is_subject_of_type = trade_dependency
					capital_scope = {
						is_nifthem_province = yes
					}
				}
				tooltip = {
					join_all_defensive_wars_of = EHR
				}
				hidden_effect = {
					country_event = {
						id = randwerpen.5
					}
				}
			}
		}
	}
	option = {
		name = randwerpen.3.b
		add_legitimacy = -15
		remove_country_modifier = randwerpian_deterrence
	}
}
## Remove unowned cores from trade dependencies after war
country_event = {
	id = randwerpen.4
	title = randwerpen.4.t
	desc = randwerpen.4.desc
	picture = RELIGION_eventPicture
	trigger = {
		has_country_flag = RAN_At_war_with_EHR
		NOT = { offensive_war_with = EHR }
	}
	#is_triggered_only = yes
	mean_time_to_happen = {
		days = 1
	}
	fire_only_once = yes
	hidden = yes

	option = {
		name = randwerpen.4.a
		every_province = {
			limit = {
				NOT = { owned_by = RAN }
				has_province_flag = RAN_nifthem_core_province_flag 
				is_nifthem_province = yes
			}
			remove_core = RAN
			add_permanent_claim = RAN
			clr_province_flag = RAN_nifthem_core_province_flag
		}
	}
}

country_event = {
	id = randwerpen.5
	title = randwerpen.5.t
	desc = randwerpen.5.desc

	picture = RELIGION_eventPicture
	
	is_triggered_only = yes

	hidden = yes
	option = {
		join_all_defensive_wars_of = EHR
	}
}

country_event = { ## Randwerpen victory
	id = randwerpen.6
	title = randwerpen.6.t
	desc = randwerpen.6.desc
	picture = DIPLOMACY_SIGNING_eventPicture

	is_triggered_only = yes
	fire_only_once = yes
	
	option = { ## subjects subjugated
		name = randwerpen.6.a
		every_province = {
			limit = {
				is_nifthem_province = yes
				owned_by = EHR
			}
			cede_province = RAN
		}
		hidden_effect = {
			add_truce_with = EHR
			EHR = {
				every_subject_country = {
					limit = {
						capital_scope = {
							region = noordland_region
						}
					}
					RAN = {
						create_subject = {
							subject_type = vassal
							who = PREV
						}
					}
					add_truce_with = RAN
					add_truce_with = EHR
				}
			}
		}
	}

	option = { ## subjects freed
		name = randwerpen.6.b
		every_province = {
			limit = {
				is_nifthem_province = yes
				owned_by = EHR
			}
			cede_province = RAN
		}
		hidden_effect = {
			add_truce_with = EHR
			EHR = {
				every_subject_country = {
					limit = {
						capital_scope = {
							region = noordland_region
						}
					}
					grant_independence = yes
					add_truce_with = RAN
					add_truce_with = EHR
				}
			}
		}
	}

}