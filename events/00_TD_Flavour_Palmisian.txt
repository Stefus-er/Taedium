namespace = palmisian


#### Aspect Events

## Province Convert
country_event = {
	id = palmisian.1
	title = palmisian.1.t
	desc = palmisian.1.desc
	picture = RELIGION_eventPicture
	trigger = {
		any_neighbor_country = {
			has_church_aspect = palmisianism_wandering_missionaries_chapter_aspect
		}
		any_owned_province = {
			any_neighbor_province = {
				religion = palmisianism
			}
		}
		NOT = {
			has_country_modifier = palmisian_missionaries_expelled
		}
	}
	
	is_triggered_only = yes

	option = { ### allow them
		name = palmisian.1.a
		random_owned_province = {
			if = {
				limit = {
					any_neighbor_province = {
						religion = palmisianism
					}
				}
				change_religion = palmisianism
			}
		}
	}
	option = { ### wtf no
		name = palmisian.1.b
		add_country_modifier = {
			name = palmisian_missionaries_expelled
			duration = 3650
		}
	}
}

#### Festival Events

## Salist Festivals

country_event = { ## salist festival #1 - Ruler uses knowledge to become smarter
	id = palmisian.2
	title = palmisian.2.t
	desc = palmisian.2.desc
	picture = RELIGION_eventPicture

	is_triggered_only = yes

	option = { ### smart!
		name = palmisian.2.a
			random_list = {
				33 = {
					if = {
						limit = {
							adm = 6
						}
						add_adm_power = 50
					}
					else = {
						change_adm = 1
					}
				}
				33 = {
					if = {
						limit = {
							dip = 6
						}
						add_dip_power = 50
					}
					else = {
						change_dip = 1
					}	
				}
				33 = {
					if = {
						limit = {
							mil = 6
						}
						add_mil_power = 50
					}
					else = {
						change_mil = 1
					}
				}
			}
	}

}

country_event = { ## salist festival #2 - people celebrate woooo
	id = palmisian.3
	title = palmisian.3.t
	desc = palmisian.3.desc
	picture = RELIGION_eventPicture

	is_triggered_only = yes

	option = { ### opotion
		name = palmisian.3.a
		every_owned_province = {
			if = {
				limit = {
					religion = palmisianism
				}
				add_province_modifier = {
					name = palmisianism_local_festivals
					duration = 1825
				}
			}
		}
	}

}

country_event = { ## salist festival #3 - bright novice advisor joins us
	id = palmisian.4
	title = palmisian.4.t
	desc = palmisian.4.desc
	picture = RELIGION_eventPicture

	is_triggered_only = yes

	option = { ### opotion
		name = palmisian.4.a
			random_list = {
				50 = {
					define_advisor = {
						skill = 1
						type = inquisitor
						discount = yes
						religion = palmisianism
					}
				}
				50 = {
					define_advisor = {
						skill = 1
						type = theologian
						discount = yes
						religion = palmisianism
					}	
				}
			}
	}

}

## Chapterist Festivals

country_event = { ## chapterist festival #1 - WAR WAR WAR WAR WAR WAR
	id = palmisian.5
	title = palmisian.5.t
	desc = palmisian.5.desc
	picture = RELIGION_eventPicture

	is_triggered_only = yes

	option = { ### opotion
		name = palmisian.5.a
		if = {
			limit = {
				any_neighbor_country = {
					NOT = {
						religion = palmisianism
					}
				}
			}
			random_neighbor_country = {
				reverse_add_casus_belli = {
    				target = PREV
   					type = cb_crusade
  					months = 120
				}
			}
		}
		else = {
			add_country_modifier = {
				name = palmisianism_holy_war_declared
				duration = 1825
			}
		}
	}

}

country_event = { ## chapterist festival #2 - our war is justified
	id = palmisian.6
	title = palmisian.6.t
	desc = palmisian.6.desc
	picture = RELIGION_eventPicture

	is_triggered_only = yes

	option = { ### opotion
		name = palmisian.6.a
		every_known_country = {
			limit = {
				religion = palmisianism
			}
			add_aggressive_expansion = {
				who = PREV
				value = -15
			}
		}
			
	}

}

country_event = { ## chapterist festival #3 - knowledge cooperative
	id = palmisian.7
	title = palmisian.7.t
	desc = palmisian.7.desc
	picture = RELIGION_eventPicture

	is_triggered_only = yes

	option = { ### opotion
		name = palmisian.7.a
		if = {
			limit = {
				any_neighbor_country = {
					religion = palmisianism
				}
			}
			random_neighbor_country = {
				limit = {
					religion = palmisianism		
				}
				add_country_modifier = {
					name = palmisianism_knowledge_cooperative
					duration = 1825
				}
			}
			add_country_modifier = {
				name = palmisianism_knowledge_cooperative
				duration = 1825
			}
		}
		else = {
			add_country_modifier = {
				name = palmisianism_knowledge_cooperative
				duration = 1825
			}
		}
	}

}

#### Palmisian Spawn

## The beginning

country_event = { ## brianoli conspiracy
	id = palmisian.1001
	title = palmisian.1001.t
	desc = palmisian.1001.desc

	picture = COUNCIL_TRENT_eventPicture

	is_triggered_only = yes
	fire_only_once = yes
	major = yes

	mean_time_to_happen = {
		months = 6
		modifier = {
			factor = 0.8
			religion = liemarian
		}
	}
	trigger = {
		tag = BRI
		had_global_flag = {
			flag = liemarian_council_started
			days = 912
		}
	}

	option = { # use them
		name = palmisian.1001.a
		set_global_flag = brianoli_palmisian_conspiracy
		custom_tooltip = brianoli_palmisian_conspiracy_tt
	}
	option = { # shut up
		name = palmisian.1001.b
	}
}

country_event = { # it spawns
	id = palmisian.1002
	title = palmisian.1002.t
	desc = palmisian.1002.desc
	picture = {	
		trigger = {
			has_dlc = "Emperor"
		}
		picture = LUTHER_eventPicture
	}
	picture = {	
		trigger = {
			NOT = { has_dlc = "Emperor" }
		}
		picture = RELIGION_eventPicture
	}
	
	major = yes
	
	trigger = {
		NOT = { is_religion_enabled = palmisianism }
		religion = liemarian
		is_defender_of_faith = no	
		is_emperor = no
		is_elector = no
		capital_scope = {
			continent = mysentria
		}
		any_owned_province = {
			can_have_center_of_reformation_trigger = {
				RELIGION = palmisianism
			}
		}
		had_global_flag = {
			flag = liemarian_council_started
			days = 2920
		}
	}
	
	mean_time_to_happen = {
		months = 6
		modifier = {
			factor = 0.5
			has_global_flag = brianoli_palmisian_conspiracy
		}
	}

	option = {
		log = "Palmisianism Spawned"
		name = palmisian.1002.a
		enable_religion = palmisianism
		random_owned_province = {
			limit = {
				can_have_center_of_reformation_trigger = {
					RELIGION = palmisianism
				}
			}
			change_religion = palmisianism
			add_reform_center = palmisianism
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
				duration = 9000
			}
			if = {
				limit = {
					NOT = { is_capital = yes }
				}
				root = {
					capital_scope = {
						change_religion = palmisianism
						add_permanent_province_modifier = {
							name = "religious_zeal_at_conv"
							duration = 9000
						}
					}
				}
			}
		}
		set_country_flag = "palmisian_reformation" 
	}
}

country_event = { # palmisian spread
	id = palmisian.1003
	title = palmisian.1003.t
	desc = palmisian.1003.desc
	picture = STREET_SPEECH_eventPicture

	trigger = {
		is_emperor = no
		is_elector = no
		is_religion_enabled = palmisianism
		religious_school = {
			group = saelian
			school = palmisianist_school
		}
		is_free_or_tributary_trigger = yes
		OR = {
			NOT = { has_country_flag = palmisianism_no }
			has_global_flag = hre_dismantled_flag
		}
	}

	mean_time_to_happen = {
		days = 8000
		modifier = {
			factor = 0.5
			capital_scope = {
				OR = {
					region = finosia_region
					region = caprotta_region
				}
			}
		}
		modifier = {
			factor = 0.5
			has_idea_group = religious_ideas
		}
		modifier = {
			factor = 3
			is_part_of_hre = yes
		}
	}

	option = { #that's interesting
		name = palmisian.1003.a
		change_religion = palmisianism
		random_owned_province = {
			limit = {
				OR = {
					religion = liemarian
					religion = sigilian
				}
			}
			change_religion = palmisianism
			add_permanent_province_modifier = {
				name = "religious_zeal_at_conv"
				duration = 9000
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = reformation_money }
			}
			add_years_of_income = 1.0
		}
		add_country_modifier = {
			name = "conversion_zeal"
			duration = 3650
		}
		ai_chance = {
			factor = 3
			modifier = {
				factor = 10
				is_rival = PAP
			}
			modifier = {
				factor = 2
				is_rival = emperor
			}
			modifier = {
				factor = 10
				has_global_flag = hre_dismantled_flag
			}
			modifier = {
				factor = 0.1
				government = theocracy
			}
			modifier = {
				factor = 0
				ruler_has_personality = zealot_personality
			}
			modifier = {
				factor = 10
				capital_scope = {
					OR = {
						region = caprotta_region
						region = finosia_region
					}
				}
			}
			modifier = {
				factor = 5
				capital_scope = {
					OR = {
						continent = venatia
						continent = chantlia
					}
				}
				OR = {
					is_free_or_tributary_trigger = yes
					overlord = { NOT = { religion = sigilian } }
				}
			}
		}
	}
	option = { #this will blew over
		name = palmisian.1003.b
		add_prestige = 15
		set_country_flag = palmisianism_no
		ai_chance = {
			factor = 1
		}
	}
}